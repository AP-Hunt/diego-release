#!/bin/bash
# vim: set ft=sh

set -e

export GOROOT=/usr/local/go
export PATH=$GOROOT/bin:$PATH

cd diego-release/

export GOPATH=$PWD
export PATH=$PWD/bin:$PATH

go install github.com/onsi/ginkgo/ginkgo

if [ -n "$PACKAGE" ]; then
  ginkgo -r -p "$@" "./src/${PACKAGE}"
else
  cd src/github.com/cloudfoundry-incubator/

  ginkgo -r -keepGoing -p -trace -randomizeAllSpecs -progress \
    ./auctioneer \
    ./tps \
    ./docker-circus \
    ./linux-circus \
    ./runtime-schema \
    ./route-emitter \
    ./nsync \
    ./converger \
    ./executor \
    ./stager \
    ./rep
fi
