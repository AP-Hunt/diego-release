#!/bin/bash -e

RUN_DIR=/var/vcap/sys/run/route_emitter
LOG_DIR=/var/vcap/sys/log/route_emitter
MONIT_LOG_DIR=/var/vcap/sys/log/monit
CONF_DIR=/var/vcap/jobs/route_emitter/config
PIDFILE=$RUN_DIR/route_emitter.pid

source /var/vcap/packages/pid_utils/pid_utils.sh

function create_directories_and_chown_to_vcap() {
  mkdir -p $RUN_DIR
  chown -R vcap:vcap $RUN_DIR

  mkdir -p $LOG_DIR
  chown -R vcap:vcap $LOG_DIR

  mkdir -p $MONIT_LOG_DIR
  chown -R vcap:vcap $MONIT_LOG_DIR

  mkdir -p $CONF_DIR
  chown -R vcap:vcap $CONF_DIR
}

function pre_setup() {
  pid_guard $PIDFILE "route_emitter"
}

function setup() {
  create_directories_and_chown_to_vcap
  pre_setup
}
setup
